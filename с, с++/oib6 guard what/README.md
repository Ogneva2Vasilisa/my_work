### **Задачи:**
1. Создать простую программу на языке С запрашивающую пароль.
2. Пользуясь исходным текстом программы и утилитой HIEW отыскать в исполняемом файле команду перехода при проверке правильности пароля и изменить ее таким образом, чтобы при вводе любого пароля программа принимала пользователя как авторизованного.
3. Получить и модифицировать код программы Nag.exe таким образом, чтобы сразу после появления всплывающего окна появлялась кнопка «Ок»
4. Распаковать исполняемый файл Guard.exe, модифицировать код таким образом, чтобы наличие отладчика не проверялось и при вводе любого пароля программа принимала пользователя как авторизованного.
5. Для разработанной в начале работы программы создать обфускатор на уровне исходных кодов.
### 1-2
В процессе работы был написан простой код, воспринимающий пароль, который хранится в отдельном файле, и разрешающий доступ для пользователя.
Для безусловного перехода применяется команда jmp (переход в любом случае), а условия обозначаются JE (перейти, если равно) и JZ (перейти, если нуль).

Правильная работа программы:
  ![](../../Pasted%20image%2020250617171849.png)
![](../../Pasted%20image%2020250617171858.png)
Работа программы после изменения на безусловный прыжок:
![](../../Pasted%20image%2020250617172009.png)

### 3
В выданном файле Nag.exe спустя 10 секунд появляется окно с таймером на 100 миллисекунд, которое блокирует любое взаимодействие с основной программой. С помощью IDA была найдена процедура SetTimer, которая отвечает за счет часов на кнопке.
Она вызывается в 2 случаях: таймер появления окна и таймер внутри окна. На вход из стека ей подаются переменные с идентификатором окна, номер события, переменная - сколько считать таймеру и переменная функции таймера:

![](../../Pasted%20image%2020250617173331.png)

Чтобы в окне nagscreen сразу показывалась кнопка OK, была изменена в ассемблере строчка сравнения в функции KillTimer, чтобы таймер заканчивался сразу. В переменной uElapse хранится число, ответственное за время, через которое окно nagscreen будет появляться. Поэтому, чтобы окно не появлялось, можно просто заполнить данную переменную максимально возможным значением.
![](../../Pasted%20image%2020250617174100.png)

### 4
Программа GUARD.exe просит ввести пароль. При вводе неверного пароля программа выдает ошибку.
  ![](../../Pasted%20image%2020250617174539.png)
  ![](../../Pasted%20image%2020250617174543.png)

При попытке загрузить программу в «IDA Pro» не получается проанализировать дизассемблированный код. Значит он упакован. Чтобы узнать тип упаковки используется программа «PEiD». В нее загружается программа и в строке «EP Section» будет указан тип упаковки, в данном случае UPX. После распаковки была найдена функция проверки пароля и было изменен условного прыжка jnz на обратный jz.
Из-за того, что условия для окна Welcome были изменены на обратные, то программа теперь предоставляет доступ по любому паролю
![](../../Pasted%20image%2020250617180304.png)
### 5
Программа обфускатор добавляет в код «мусорные» переменные и функции, а также меняет названия переменных в коде. Обфускация помогает сделать программу более защищенной от отладки и анализа, но ни один из существующих обфускаторов не гарантирует абсолютной невозможности восстановления логики работы программы.
Код из п.1-2 до и после работы обфускатора:
![](../../Pasted%20image%2020250617180417.png)
![](../../Pasted%20image%2020250617180420.png)
Граф программы до и после работы обфускатора
![](../../Pasted%20image%2020250617180453.png)
## Анализ работы
В результате работы были разработаны программа, запрашивающая пароль, хранящийся в закрытом виде и программа-обфускатор, а также было реализовано обхождение защиты через дисассемблер.